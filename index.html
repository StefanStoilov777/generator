<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Генератор на Уравнения</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        .input-group {
            margin: 10px 0;
        }
        label {
            display: inline-block;
            margin: 5px 10px 5px 0;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Генератор на Уравнения</h1>
    
    <div class="input-group">
        <label>Диапазон на отговорите:<br>
            От: <input type="number" id="answerMin" value="0" min="0">
            До: <input type="number" id="answerMax" value="20" min="1">
        </label>
    </div>
    
    <div class="input-group">
        <label>Максимално число в уравненията:
            <input type="number" id="equationMax" value="30" min="1">
        </label>
    </div>
    
    <div class="input-group">
        <label>Брой уравнения:
            <select id="numEquations">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="30" selected>30</option>
                <option value="40">40</option>
                <option value="50">50</option>
            </select>
        </label>
    </div>
    
    <div class="input-group">
        <label><input type="checkbox" id="addition" checked> Събиране</label>
        <label><input type="checkbox" id="subtraction" checked> Изваждане</label>
        <label><input type="checkbox" id="multiplication"> Умножение</label>
        <label><input type="checkbox" id="division"> Деление</label>
    </div>
    
    <button onclick="generateDocuments()">Генерирай DOC</button>

    <script>
        function numberToBulgarian(num) {
            if (num === 0) return 'нула';
            const units = ['','едно','две','три','четири','пет','шест','седем','осем','девет'];
            const teens = ['десет','единадесет','дванадесет','тринадесет','четиринадесет',
                         'петнадесет','шестнадесет','седемнадесет','осемнадесет','деветнадесет'];
            const tens = ['','','двадесет','тридесет','четиридесет','петдесет',
                        'шестдесет','седемдесет','осемдесет','деветдесет'];

            if (num < 10) return units[num];
            if (num >= 10 && num < 20) return teens[num - 10];
            
            const ten = Math.floor(num / 10);
            const unit = num % 10;
            return tens[ten] + (unit > 0 ? ' и ' + units[unit] : '');
        }

        function createDocContent(content, title) {
            return `<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head><meta charset="UTF-8"><title>${title}</title>
<style>td {font-size: 16pt; font-family: Arial; padding: 15px 0; line-height: 1.5;}</style>
</head><body><table>${content.map(line => `<tr><td>${line}</td></tr>`).join('')}</table></body></html>`;
        }

        function generateDocuments() {
            const answerMin = parseInt(document.getElementById('answerMin').value);
            const answerMax = parseInt(document.getElementById('answerMax').value);
            const equationMax = parseInt(document.getElementById('equationMax').value);
            const numEquations = parseInt(document.getElementById('numEquations').value);
            const operations = [];
            const operationMap = {
                addition: 'плюс',
                subtraction: 'минус',
                multiplication: 'умножено по',
                division: 'разделено на'
            };

            if (document.getElementById('addition').checked) operations.push('addition');
            if (document.getElementById('subtraction').checked) operations.push('subtraction');
            if (document.getElementById('multiplication').checked) operations.push('multiplication');
            if (document.getElementById('division').checked) operations.push('division');

            if (operations.length === 0) return alert('Изберете поне една операция!');
            if (answerMin >= answerMax) return alert('Максималната стойност на отговорите трябва да е по-голяма от минималната!');
            if (equationMax < answerMax) return alert('Максималното число в уравненията трябва да е по-голямо или равно на максималния отговор!');

            let problems = [];
            for (let i = 0; i < numEquations; i++) {
                const operation = operations[Math.floor(Math.random() * operations.length)];
                let a, b, result;

                // Generate result first within answer range
                result = Math.floor(Math.random() * (answerMax - answerMin + 1)) + answerMin;

                if (operation === 'addition') {
                    a = Math.floor(Math.random() * (Math.min(equationMax, result - 1) - 1 + 1)) + 1;
                    b = result - a;
                    while(b < 1 || b > equationMax) {
                        a = Math.floor(Math.random() * (Math.min(equationMax, result - 1) - 1 + 1)) + 1;
                        b = result - a;
                    }
                } 
                else if (operation === 'subtraction') {
                    b = Math.floor(Math.random() * (equationMax - 1 + 1)) + 1;
                    a = result + b;
                    while(a > equationMax) {
                        b = Math.floor(Math.random() * (equationMax - 1 + 1)) + 1;
                        a = result + b;
                    }
                }
                else if (operation === 'multiplication') {
                    const factors = [];
                    for(let x = 1; x <= equationMax; x++) {
                        if(result % x === 0 && (result / x) <= equationMax) {
                            factors.push(x);
                        }
                    }
                    if(factors.length === 0) continue;
                    a = factors[Math.floor(Math.random() * factors.length)];
                    b = result / a;
                }
                else if (operation === 'division') {
                    b = Math.floor(Math.random() * (equationMax - 1 + 1)) + 1;
                    a = result * b;
                    while(a > equationMax) {
                        b = Math.floor(Math.random() * (equationMax - 1 + 1)) + 1;
                        a = result * b;
                    }
                }

                const aWord = numberToBulgarian(a);
                const bWord = numberToBulgarian(b);
                
                const question = `${aWord} ${operationMap[operation]} ${bWord} е равно на: (     )`;
                const answer = `${aWord} ${operationMap[operation]} ${bWord} е равно на: (${result})`;
                
                problems.push({ question, answer });
            }

            // Create documents
            const exerciseContent = createDocContent(problems.map(p => p.question), "Упражнения");
            const answerContent = createDocContent(problems.map(p => p.answer), "Отговори");

            function download(content, filename) {
                const blob = new Blob([content], { type: 'application/msword' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            download(exerciseContent, 'bulgarian_equations.doc');
            setTimeout(() => download(answerContent, 'bulgarian_answers.doc'), 100);
        }
    </script>
</body>
</html>
